{% extends "base.html" %}
{% block content %}
<h1>Sign Up</h1>
<form method="POST" action="{{ url_for('signup') }}">
    <input type="text" name="username" placeholder="Username" required>
    <input type="email" name="email" placeholder="Email" required>
    <input type="password" name="password" placeholder="Password" required>
    <p>
        <label>
            <input type="radio" name="user_type" value="student" checked>
            Student
        </label>
        <label>
            <input type="radio" name="user_type" value="teacher">
            Teacher
        </label>
    </p>

    <!-- Student-specific field -->
    <div id="student_fields" style="display: block;">
        <input type="text" id="student_class_code" name="class_code" placeholder="Enter Class Code" required>
    </div>

    <!-- Teacher-specific fields -->
    <div id="teacher_fields" style="display: none;">
        <p>
            <label>
                <input type="radio" name="teacher_action" value="create" checked>
                Create a new class
            </label>
            <label>
                <input type="radio" name="teacher_action" value="join">
                Join an existing class
            </label>
        </p>
        <div id="teacher_join_class" style="display: none;">
            <input type="text" id="teacher_class_code" name="class_code" placeholder="Enter Class Code" required>
        </div>
    </div>

    <button type="submit">Register</button>
</form>
<div class="links">
    <p>Already have an account? <a href="{{ url_for('login') }}">Log In</a></p>
</div>

<script>
    const userTypeRadios = document.querySelectorAll('input[name="user_type"]');
    const teacherActionRadios = document.querySelectorAll('input[name="teacher_action"]');
    const studentFields = document.getElementById('student_fields');
    const teacherFields = document.getElementById('teacher_fields');
    const studentClassCodeInput = document.getElementById('student_class_code');
    const teacherJoinClassDiv = document.getElementById('teacher_join_class');
    const teacherClassCodeInput = document.getElementById('teacher_class_code');

    function toggleFields() {
        if (document.querySelector('input[name="user_type"][value="student"]').checked) {
            studentFields.style.display = 'block';
            teacherFields.style.display = 'none';
            studentClassCodeInput.required = true;
            teacherClassCodeInput.required = false;
        } else {
            studentFields.style.display = 'none';
            teacherFields.style.display = 'block';
            studentClassCodeInput.required = false;
            
            // Check teacher action
            if (document.querySelector('input[name="teacher_action"][value="join"]').checked) {
                teacherJoinClassDiv.style.display = 'block';
                teacherClassCodeInput.required = true;
            } else {
                teacherJoinClassDiv.style.display = 'none';
                teacherClassCodeInput.required = false;
            }
        }
    }

    userTypeRadios.forEach(radio => radio.addEventListener('change', toggleFields));
    teacherActionRadios.forEach(radio => radio.addEventListener('change', toggleFields));
    
    // Set initial state
    toggleFields();
</script>
{% endblock %}
